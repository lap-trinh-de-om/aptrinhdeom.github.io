<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="N√≥ l√† vi·∫øt t·∫Øt c·ªßa `JSON Web Token`, JWT l√† 1 chu·ªói JSON ƒë∆∞·ª£c m√£ h√≥a, JWT l√† ph∆∞∆°ng th·ª©c ƒë·ªÉ giao ti·∫øp gi·ªØa Back-End v√† Front-End"><title>JWT l√† g√¨? T·∫•t t·∫ßn t·∫≠t v·ªÅ JWT</title><link rel=canonical href=https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/><link rel=stylesheet href=/scss/style.min.css><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!="dataLayer"?"&l="+a:"";c.async=!0,c.src="https://www.googletagmanager.com/gtm.js?id="+g+h,f.parentNode.insertBefore(c,f)})(window,document,"script","dataLayer","GTM-NVL9VTK")</script><meta property="og:title" content="JWT l√† g√¨? T·∫•t t·∫ßn t·∫≠t v·ªÅ JWT"><meta property="og:description" content="N√≥ l√† vi·∫øt t·∫Øt c·ªßa `JSON Web Token`, JWT l√† 1 chu·ªói JSON ƒë∆∞·ª£c m√£ h√≥a, JWT l√† ph∆∞∆°ng th·ª©c ƒë·ªÉ giao ti·∫øp gi·ªØa Back-End v√† Front-End"><meta property="og:url" content="https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/"><meta property="og:site_name" content="L·∫≠p Tr√¨nh D·ªÖ √ím.xyz"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Security"><meta property="article:tag" content="B·∫£o m·∫≠t"><meta property="article:tag" content="JWT"><meta property="article:tag" content="JSON Web Token"><meta property="article:published_time" content="2021-06-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-14T00:00:00+00:00"><meta property="og:image" content="https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover.png"><meta name=twitter:title content="JWT l√† g√¨? T·∫•t t·∫ßn t·∫≠t v·ªÅ JWT"><meta name=twitter:description content="N√≥ l√† vi·∫øt t·∫Øt c·ªßa `JSON Web Token`, JWT l√† 1 chu·ªói JSON ƒë∆∞·ª£c m√£ h√≥a, JWT l√† ph∆∞∆°ng th·ª©c ƒë·ªÉ giao ti·∫øp gi·ªØa Back-End v√† Front-End"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-VMYS7CXX5Q"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-VMYS7CXX5Q',{anonymize_ip:!1})}</script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NVL9VTK" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.body.dataset.scheme='dark':document.body.dataset.scheme='light'})()</script><div class="container main-container flex on-phone--column extended article-page with-toolbar"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=/img/logo_hu24e9b3dbe3a18967143a698004067214_28795_300x0_resize_box_2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>üç∞</span></figure><h1 class=site-name><a href=https://www.laptrinhdeom.xyz>L·∫≠p Tr√¨nh D·ªÖ √ím.xyz</a></h1><h2 class=site-description>Chia s·∫ª ki·∫øn th·ª©c v√† kinh nghi·ªám l·∫≠p tr√¨nh.</h2></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Trang ch·ªß</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>Gi·ªõi thi·ªáu</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Kho l∆∞u tr·ªØ</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>T√¨m ki·∫øm</span></a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></ol></aside><main class="main full-width"><div id=article-toolbar><a href=https://www.laptrinhdeom.xyz class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover_hu6769fb9f126c77eafe45523142ac731e_39456_800x0_resize_box_2.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover_hu6769fb9f126c77eafe45523142ac731e_39456_800x0_resize_box_2.png 800w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/cover_hu6769fb9f126c77eafe45523142ac731e_39456_1600x0_resize_box_2.png 1600w" width=800 height=342 loading=lazy alt="Featured image of post JWT l√† g√¨? T·∫•t t·∫ßn t·∫≠t v·ªÅ JWT"></a></div><div class=article-details><header class=article-category><a href=/categories/security/>Security</a>
<a href=/categories/b%E1%BA%A3o-m%E1%BA%ADt/>B·∫£o m·∫≠t</a>
<a href=/categories/jwt/>JWT</a>
<a href=/categories/json-web-token/>JSON Web Token</a></header><h2 class=article-title><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/>JWT l√† g√¨? T·∫•t t·∫ßn t·∫≠t v·ªÅ JWT</a></h2><h3 class=article-subtitle>N√≥ l√† vi·∫øt t·∫Øt c·ªßa `JSON Web Token`, JWT l√† 1 chu·ªói JSON ƒë∆∞·ª£c m√£ h√≥a, JWT l√† ph∆∞∆°ng th·ª©c ƒë·ªÉ giao ti·∫øp gi·ªØa Back-End v√† Front-End</h3><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>Jun 14, 2021</time></footer></div></header><section class=article-content><h3 id=-jwt-l√†-g√¨-v·∫≠y-nh·ªâ>‚úÖ JWT l√† g√¨ v·∫≠y nh·ªâ?</h3><ul><li>N√≥ l√† vi·∫øt t·∫Øt c·ªßa <code>JSON Web Token</code></li><li>JWT l√† 1 chu·ªói JSON ƒë∆∞·ª£c m√£ h√≥a, n√≥ tr√¥ng th·∫ø n√†y ƒë√¢y:</li></ul><div class=highlight><pre class=chroma><code class=language-makefile data-lang=makefile><span class=err>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.</span>
<span class=err>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.</span>
<span class=err>SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span>
</code></pre></div><ul><li>C√°c b·∫°n copy chu·ªói tr√™n, xong v√†o <a class=link href=https://jwt.io/ target=_blank rel=noopener>ƒë√¢y</a> d√°n v√†o xem th·ª≠ n√≥ th·∫ø n√†o nh√© üôÇ</li><li>JWT l√† ph∆∞∆°ng th·ª©c ƒë·ªÉ giao ti·∫øp gi·ªØa Back-End v√† Front-End (<code>Stateless</code>).
Nghƒ©a l√† Back-End ch·ªâ t·∫°o ra 1 chu·ªói token cho user khi ƒëƒÉng nh·∫≠p, v√† tr·∫£ chu·ªói n√†y v·ªÅ Front-End, Back-End ho√†n to√†n kh√¥ng l∆∞u tr·ªØ token n√†y tr√™n server.</li><li>C∆° ch·∫ø ho·∫°t ƒë·ªông gi·ªëng nh∆∞ h√¨nh d∆∞·ªõi ƒë√¢y:</li></ul><p><figure style=flex-grow:298;flex-basis:715px><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt.png data-size=2112x708><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt_hud5e499587e4094707b1a90ad61266e85_96008_480x0_resize_box_2.png 480w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt_hud5e499587e4094707b1a90ad61266e85_96008_1024x0_resize_box_2.png 1024w" width=2112 height=708 loading=lazy alt=01-jwt.png></a><figcaption>01-jwt.png</figcaption></figure></p><h3 id=-t·∫°i-sao-jwt-l·∫°i-sinh-ra>‚úÖ T·∫°i sao JWT l·∫°i sinh ra?</h3><ul><li>Tr∆∞·ªõc ƒë√¢y ch√∫ng ta l·∫≠p tr√¨nh web, l√∫c ƒë√≥ ƒëi·ªán tho·∫°i di ƒë·ªông ch∆∞a ph·ªï bi·∫øn, n√™n kh√¥ng c√≥ app cho ƒëi·ªán tho·∫°i di ƒë·ªông, v√¨ th·∫ø ch·ªâ s·ª≠ d·ª•ng c∆° ch·∫ø x√°c th·ª±c ng∆∞·ªùi d√πng b·∫±ng <code>Session Based</code>.</li><li>Session Based l√† g√¨?<ul><li><p>C√°c b·∫°n xem h√¨nh d∆∞·ªõi ƒë√¢y:</p><p><figure style=flex-grow:298;flex-basis:715px><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based.png data-size=2112x708><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based_hucdd257f931a157b5c0dadba83af15119_102105_480x0_resize_box_2.png 480w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based_hucdd257f931a157b5c0dadba83af15119_102105_1024x0_resize_box_2.png 1024w" width=2112 height=708 loading=lazy alt=02-session-based.png></a><figcaption>02-session-based.png</figcaption></figure></p></li><li><p>C√°c b·∫°n th·∫•y n√≥ c≈©ng t∆∞∆°ng t·ª± v·ªõi JWT, nh∆∞ng kh√°c nhau ch·ªó kh√¥ng x√†i JWT m√† x√†i cookie ph·∫£i kh√¥ng?</p></li><li><p>ƒê√∫ng v·∫≠y n√≥ s·∫Ω d√πng <code>cookie</code> ƒë·ªÉ ƒë·ªãnh danh ng∆∞·ªùi d√πng, v√† <code>sessionId</code> s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ tr√™n ph√≠a server, ·ªü d·∫°ng text.</p></li><li><p>ƒê·ªÉ bi·∫øt ng∆∞·ªùi d√πng ƒë√£ ƒëƒÉng nh·∫≠p hay ch∆∞a, v√† id c·ªßa user l√† g√¨&mldr;</p></li></ul></li><li>Sau khi c√≥ website ch·∫°y v·ªõi session based r·ªìi, gi·ªù ƒë·ªôt nhi√™n c√≥ nhu c·∫ßu th√™m 1 app cho ƒëi·ªán tho·∫°i n·ªØa, v·∫≠y ph·∫£i l√†m th·∫ø n√†o?</li><li>App tr√™n ƒëi·ªán tho·∫°i ƒë√¢u c√≥ cookie ƒë·ªÉ x√†i sessionId nh∆∞ web ƒë∆∞·ª£c???</li><li>Cu·ªëi c√πng, 1 c∆° ch·∫ø m·ªõi ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a ra ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, ƒë√≥ l√† d√πng Json Web Token. N√≥ mang ch·ªØ web th√¥i, nh∆∞ng x√†i ·ªü ƒë√¢u c≈©ng ƒë∆∞·ª£c.</li></ul><h3 id=-trong-chu·ªói-jwt-c√≥-nh·ªØng-g√¨-v·∫≠y>‚úÖ Trong chu·ªói JWT c√≥ nh·ªØng g√¨ v·∫≠y?</h3><p>JWT c√≥ 3 ph·∫ßn: Header, Payload v√† Signature, chi ti·∫øt c√°c b·∫°n c√≥ th·ªÉ xem h√¨nh d∆∞·ªõi:</p><ul><li><p><code>Header</code>, trong header s·∫Ω c√≥ 2 thu·ªôc t√≠nh:</p><ul><li><code>alg</code>: thu·∫≠t to√°n m√£ ho√° c·ªßa JWT, th∆∞·ªùng s·∫Ω l√† <code>HS256</code></li><li><code>typ</code>: lo·∫°i token, th∆∞·ªùng s·∫Ω l√† <code>JWT</code></li></ul></li><li><p><code>Payload</code>: l√† n∆°i ch·ª©a c√°c data c·∫ßn thi·∫øt ƒë·ªÉ ƒë·ªãnh danh user, v√≠ d·ª• user id, email, v√† c√°c th√¥ng tin kh√°c th∆∞·ªùng d√πng nh∆∞ sau:</p><p><a class=link href=https://www.notion.so/e79c084210a744018be222359ca0ce18 target=_blank rel=noopener>JWT Payload keys</a></p><ul><li>C√°c th√¥ng tin c√°c c√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o ·ªü ƒë√¢y: <a class=link href=https://en.wikipedia.org/wiki/JSON_Web_Token#Standard_fields target=_blank rel=noopener>https://en.wikipedia.org/wiki/JSON_Web_Token#Standard_fields</a></li></ul></li><li><p><code>Signature</code>: l√† ch·ªØ k√Ω ƒëi·ªán t·ª≠ c·ªßa JWT, d√πng ƒë·ªÉ verify JWT n√†y c√≥ ƒë∆∞·ª£c t·∫°o ra ƒë√∫ng kh√¥ng, d·ª±a tr√™n thu·∫≠t to√°n m√£ ho√° nh∆∞ sau:</p><ol><li><code>base64UrlEncode(header)</code></li><li><code>base64UrlEncode(payload)</code></li><li><code>HMACSHA256(#1, #2, secretKey)</code></li></ol><ul><li><code>secretKey</code> l√† chu·ªói ng·∫´u nhi√™n ƒë∆∞·ª£c l∆∞u tr·ªØ tr√™n server</li><li><code>secretKey</code> d√πng ƒë·ªÉ t·∫°o ra Signature cho JWT v√† verify JWT c√≥ h·ª£p l·ªá hay kh√¥ng.</li></ul><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>signature</span> <span class=o>=</span> <span class=nx>HMACSHA256</span><span class=p>(</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>payload</span><span class=p>),</span>
  <span class=nx>secret</span>
<span class=p>);</span>

<span class=kd>var</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>payload</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span> <span class=nx>signature</span><span class=p>;</span>
</code></pre></div></li></ul><h3 id=-jwt-ho·∫°t-ƒë·ªông-th·∫ø-n√†o-v·∫≠y>‚úÖ JWT ho·∫°t ƒë·ªông th·∫ø n√†o v·∫≠y?</h3><ul><li>C∆° ch·∫ø JWT kh√° ƒë∆°n gi·∫£n:<ul><li>Server sau khi x√°c th·ª±c ƒë√∫ng user th√¨ tr·∫£ v·ªÅ 1 chu·ªói m√£ ho√° cho client</li><li>Client l∆∞u l·∫°i m√£ n√†y ·ªü local, c√≥ th·ªÉ l∆∞u ·ªü <code>cookie, localStorate, AsyncStorage, SharedPreferences...</code> hay b·∫•t c·ª© ƒë√¢u b·∫°n mu·ªën m√† c√≥ th·ªÉ truy c·∫≠p nhanh ƒë·ªÉ l·∫•y gi√° tr·ªã l√† ƒë∆∞·ª£c.</li><li>M·ªói request sau l√™n server th√¨ set JWT v√†o header tr∆∞·ªõc khi g·ª≠i l√™n.</li><li>Server l·∫•y JWT t·ª´ header, <code>verify</code> coi th·ª≠ JWT c√≥ h·ª£p l·ªá kh√¥ng, h·ª£p l·ªá th√¨ cho v√†o, kh√¥ng th√¨ ƒë√° l·ªói <code>401</code> v·ªÅ cho client.</li></ul></li><li>C√°c b·∫°n c√≥ th·ªÉ tham kh·∫£o ·ªü h√¨nh d∆∞·ªõi s·∫Ω chi ti·∫øt h∆°n:</li></ul><p><figure style=flex-grow:100;flex-basis:240px><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow.png data-size=2112x2112><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow_hu8d253bb90a7042289f3a77f2bb36fb04_295764_480x0_resize_box_2.png 480w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow_hu8d253bb90a7042289f3a77f2bb36fb04_295764_1024x0_resize_box_2.png 1024w" width=2112 height=2112 loading=lazy alt=03-jwt-workflow.png></a><figcaption>03-jwt-workflow.png</figcaption></figure></p><h3 id=-l√†m-th·∫ø-n√†o-ƒë·ªÉ-verify-jwt-c√≥-h·ª£p-l·ªá-kh√¥ng-nh·ªâ>‚úÖ L√†m th·∫ø n√†o ƒë·ªÉ verify JWT c√≥ h·ª£p l·ªá kh√¥ng nh·ªâ?</h3><ul><li>ƒê·ªÉ verify 1 chu·ªói JWT c√≥ h·ª£p l·ªá hay kh√¥ng th√¨ n√≥ s·∫Ω th·∫ø n√†y:<ul><li><p>ƒê·∫ßu ti√™n, server s·∫Ω gi·∫£i m√£ (decode) chu·ªói JWT c·ªßa header v√† payload ra, trong payload s·∫Ω c√≥ c√°c th√¥ng tin nh∆∞:</p><ul><li><code>iss</code>: Ng∆∞·ªùi t·∫°o l√† ai</li><li><code>nbf</code>: Not before, token n√†y c√≥ t·ªõi th√≤i ƒëi·ªÉm h·ª£p l·ªá ch∆∞a</li><li><code>exp</code>: Expiration time, token n√†y c√≥ h·∫øt h·∫°n ch∆∞a</li></ul></li><li><p>Server ki·ªÉm tra c√°c th√¥ng tin tr√™n, n·∫øu b·∫•t c·ª© th√¥ng tin n√†o kh√¥ng h·ª£p l·ªá, th√¨ s·∫Ω tr·∫£ l·ªói ra.</p></li><li><p>Ti·∫øp theo server s·∫Ω th·ª≠ hash header v√† payload v·ªõi thu·∫≠t to√°n t·∫°o JWT tr√™n ƒë·ªÉ so s√°nh v·ªõi Signature c√≥ gi·ªëng kh√¥ng, n·∫øu kh√¥ng gi·ªëng th√¨ c≈©ng tr·∫£ ra l·ªói.</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>signature</span> <span class=o>=</span> <span class=nx>HMACSHA256</span><span class=p>(</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>payload</span><span class=p>),</span>
  <span class=nx>secret</span>
<span class=p>);</span>
</code></pre></div></li><li><p>C√°c b·∫°n th·ª≠ t·∫°o theo thu·∫≠t to√°n n√†y xem c√≥ ra ƒë∆∞·ª£c chu·ªói JWT kh√¥ng nh√© üòâ</p></li></ul></li></ul><h3 id=-th·ª≠-t·∫°o-1-chu·ªói-jwt-b·∫±ng-nodejs-nh∆∞-th·∫ø-n√†o>‚úÖ Th·ª≠ t·∫°o 1 chu·ªói JWT b·∫±ng NodeJS nh∆∞ th·∫ø n√†o?</h3><ul><li>B√¢y gi·ªù ch√∫ng ta th·ª≠ d√πng NodeJS t·∫°o ra 1 chu·ªói JWT th·ª≠ xem nh√©.<ul><li><p>B·∫°n t·∫°o 1 file <code>create-jwt.js</code></p></li><li><p>Ti·∫øp t·ª•c b·∫°n ch·∫°y l·ªánh: <code>npm init</code>, xong l√†m theo h∆∞·ªõng d·∫´n tr√™n terminal:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kr>package</span> <span class=nx>name</span><span class=o>:</span> <span class=p>(</span><span class=nx>demo</span><span class=o>-</span><span class=nx>jwt</span><span class=p>)</span> 
<span class=nx>version</span><span class=o>:</span> <span class=p>(</span><span class=mf>1.0.0</span><span class=p>)</span> 
<span class=nx>description</span><span class=o>:</span> 
<span class=nx>entry</span> <span class=nx>point</span><span class=o>:</span> <span class=p>(</span><span class=nx>index</span><span class=p>.</span><span class=nx>js</span><span class=p>)</span> 
<span class=nx>test</span> <span class=nx>command</span><span class=o>:</span> 
<span class=nx>git</span> <span class=nx>repository</span><span class=o>:</span> 
<span class=nx>keywords</span><span class=o>:</span> 
<span class=nx>author</span><span class=o>:</span> 
<span class=nx>license</span><span class=o>:</span> <span class=p>(</span><span class=nx>ISC</span><span class=p>)</span> 
<span class=nx>About</span> <span class=nx>to</span> <span class=nx>write</span> <span class=nx>to</span> <span class=o>/</span><span class=nx>home</span><span class=o>/</span><span class=nx>username</span><span class=o>/</span><span class=nx>demo</span><span class=o>-</span><span class=nx>jwt</span><span class=o>/</span><span class=kr>package</span><span class=p>.</span><span class=nx>json</span><span class=o>:</span>

<span class=p>{</span>
  <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=s2>&#34;demo-jwt&#34;</span><span class=p>,</span>
  <span class=s2>&#34;version&#34;</span><span class=o>:</span> <span class=s2>&#34;1.0.0&#34;</span><span class=p>,</span>
  <span class=s2>&#34;description&#34;</span><span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
  <span class=s2>&#34;main&#34;</span><span class=o>:</span> <span class=s2>&#34;index.js&#34;</span><span class=p>,</span>
  <span class=s2>&#34;scripts&#34;</span><span class=o>:</span> <span class=p>{</span>
    <span class=s2>&#34;test&#34;</span><span class=o>:</span> <span class=s2>&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>
  <span class=p>},</span>
  <span class=s2>&#34;author&#34;</span><span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
  <span class=s2>&#34;license&#34;</span><span class=o>:</span> <span class=s2>&#34;ISC&#34;</span>
<span class=p>}</span>

<span class=nx>Is</span> <span class=k>this</span> <span class=nx>OK</span><span class=o>?</span> <span class=p>(</span><span class=nx>yes</span><span class=p>)</span>
</code></pre></div></li><li><p>Gi·ªù b·∫°n ch·∫°y ti·∫øp l·ªánh n√†y: <code>npm install jsonwebtoken</code></p></li><li><p>Xong t·∫°o file <code>create-jwt.js</code> v·ªõi n·ªôi dung sau:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>

<span class=kd>var</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span>
  <span class=nx>sub</span><span class=o>:</span> <span class=s1>&#39;e271a680-3e55-45bd-bbcf-aa4576ac835f&#39;</span><span class=p>,</span>
  <span class=nx>iss</span><span class=o>:</span> <span class=s1>&#39;JWT Demo&#39;</span><span class=p>,</span>
  <span class=nx>iat</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>)</span> <span class=o>-</span> <span class=mi>30</span><span class=p>,</span>
  <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>test</span><span class=o>:</span> <span class=s1>&#39;abc&#39;</span>
  <span class=p>}</span>
<span class=p>},</span> <span class=s1>&#39;secretKey@123&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;1m&#39;</span> <span class=p>});</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=nx>token</span><span class=p>);</span>
</code></pre></div></li><li><p>V·∫≠y l√† xong ph·∫ßn t·∫°o JWT v·ªõi nodejs r·ªìi, gi·ªù ch·∫°y th·ª≠: <code>node create-jwt.js</code></p></li><li><p>B·∫°n s·∫Ω th·∫•y k·∫øt qu·∫£ nh∆∞ sau:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=nx>token</span> <span class=nx>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><span class=p>.</span>
      <span class=nx>eyJzdWIiOiJlMjcxYTY4MC0zZTU1LTQ1YmQtYmJjZi1hYTQ1NzZhYzgzNWYiLCJpc3MiOiJKV1QgRGVtbyIsImRhdGEiOnsidGVzdCI6ImFiYyJ9fQ</span><span class=p>.</span>
      <span class=mi>3</span><span class=nx>ibxGqZi7n</span><span class=o>-</span><span class=mi>3</span><span class=nx>MjwbuKAYBkFYVwf59qUZt6Q6nbgp_wI</span>
</code></pre></div></li><li><p>B·∫°n th·ª≠ copy quƒÉng v√¥ <a class=link href=http://jwt.io target=_blank rel=noopener>jwt.io</a> xem th·ª≠ ƒë∆∞·ª£c th√¥ng tin g√¨ nh√© üòé</p></li></ul></li></ul><h3 id=-th·ª≠-verify-chu·ªói-jwt-v·ªõi-nodejs-n√†o>‚úÖ Th·ª≠ verify chu·ªói JWT v·ªõi nodejs n√†o.</h3><ul><li>Sau khi t·∫°o xong JWT th√¨ m√¨nh verify chu·ªói xem h·ª£p l·ªá hay kh√¥ng nh√©.<ul><li><p>T·∫°o file <code>verify-jwt.js</code> v·ªõi n·ªôi dung sau:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>token</span> <span class=o>=</span> <span class=s1>&#39;...&#39;</span><span class=p>;</span> <span class=c1>// Thay token ·ªü tr√™n v√†o ch·ªó d·∫•u ... hen.
</span><span class=c1></span>
<span class=k>try</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=s1>&#39;secretKey@123);
</span><span class=s1>  console.log(&#39;</span><span class=nx>token</span> <span class=nx>data</span><span class=s1>&#39;, decoded);
</span><span class=s1>} catch(err) {
</span><span class=s1>  console.log(&#39;</span><span class=nx>Kh√¥ng</span> <span class=nx>th·ªÉ</span> <span class=nx>verify</span> <span class=nx>token</span> <span class=nx>n√†y</span><span class=err>&#39;</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></li><li><p>B·∫°n ch·∫°y th·ª≠ <code>node verify-jwt.js</code> xem k·∫øt qu·∫£ th·∫ø n√†o nh√© üòá</p></li></ul></li></ul><h3 id=-th·ª≠-hack-jwt-c√≥-ƒë∆∞·ª£c-kh√¥ng>‚úÖ Th·ª≠ hack JWT c√≥ ƒë∆∞·ª£c kh√¥ng?</h3><ul><li>B√¢y gi·ªù m√¨nh c√≥ t√¨nh hu·ªëng th·∫ø n√†y:<ol><li>B·∫°n t·∫°o 1 JWT ·ªü tr√™n</li><li>Copy d√°n v√†o <a class=link href=http://jwt.io target=_blank rel=noopener>jwt.io</a></li><li>Copy ph·∫ßn <code>Signature</code> ƒë·ªÉ gi·ªØ l·∫°i ƒë√¢u ƒë√≥, c√≥ th·ªÉ d√°n v√†o IDE ƒë·ªÉ gi·ªØ l·∫°i t√≠ m√¨nh c√≥ vi·ªác d√πng l·∫°i nh√© üòÇ</li><li>S·ª≠a l·∫°i payload ph·∫ßn <code>sub</code> th√†nh 1 id c·ªßa admin</li><li><a class=link href=http://jwt.io target=_blank rel=noopener>jwt.io</a> t·ª± t·∫°o l·∫°i 1 chu·ªói JWT m·ªõi, <code>Signature</code> ho√†n to√†n kh√°c.</li><li>Copy chu·ªói m·ªõi, d√°n v√†o file <code>verify-jwt.js</code> v√† ch·∫°y th·ª≠.</li></ol></li><li>T√¨nh hu·ªëng kh√°c, ti·∫øp theo t√¨nh hu·ªëng tr√™n nh√©:<ol><li>Copy <code>Signature</code> l√∫c n√£y gi·ªØ l·∫°i.</li><li>D√°n v√†o ph·∫ßn `</li></ol></li></ul><h3 id=-∆∞u-nh∆∞·ª£c-ƒëi·ªÉm-c·ªßa-jwt-l√†-g√¨>‚úÖ ∆Øu, nh∆∞·ª£c ƒëi·ªÉm c·ªßa JWT l√† g√¨?</h3><p>(ƒêang c·∫≠p nh·∫≠t)</p><h3 id=-l√†m-sao-ƒë·ªÉ-logout-1-user-ƒëang-x√†i-jwt-h·ª£p-l·ªá-tr∆∞·ªõc-th·ªùi-h·∫°n>‚úÖ L√†m sao ƒë·ªÉ logout 1 user ƒëang x√†i JWT h·ª£p l·ªá tr∆∞·ªõc th·ªùi h·∫°n?</h3><ul><li>Khi s·ª≠ d·ª•ng <code>Session based</code> th√¨ <code>sessionId</code> ƒë∆∞·ª£c l∆∞u tr√™n server, khi user logout th√¨ ch√∫ng ta ch·ªâ vi·ªác x√≥a <code>sessionId</code> tr√™n server l√† xong.</li><li>Nh∆∞ng ƒëang d√πng JWT, server kh√¥ng l∆∞u l·∫°i, th√¨ l√†m sao ƒë·ªÉ logout user nh·ªâ?<ul><li>Kh√¥ng c√≥ c√°ch n√†o logout 1 user khi h·ªç ƒëang s·ª≠ d·ª•ng JWT, nghƒ©a l√† cho d√π user ƒë√£ nh·∫•n n√∫t logout r·ªìi, nh∆∞ng l·∫•y JWT ƒë√≥ v·∫´n request l√™n server b√¨nh th∆∞·ªùng nh√©, server kh√¥ng h·ªÅ bi·∫øt ƒë∆∞·ª£c user ƒë√£ logout r·ªìi.</li><li>V·∫≠y c√°ch n√†o ƒë·ªÉ t·ª´ ch·ªëi c√°c request sau khi user ƒë√£ logout? Ch√∫ng ta c√≥ 1 c√°ch l√†:<ul><li>Khi user logout, g·ª≠i token l√™n server v·ªõi request logout.</li><li>Server l∆∞u l·∫°i JWT ƒë√£ logout tr√™n Redis ho·∫∑c 1 n∆°i n√†o ƒë√≥.</li><li>B·∫•t c·ª© request n√†o l√™n server th√¨ server ki·ªÉm tra JWT c√≥ tr√™n ch·ªó l∆∞u JWT ƒë√£ logout hay kh√¥ng, n·∫øu c√≥ th√¨ t·ª´ ch·ªëi request, ƒë√° l·ªói 401 Unauthorized v·ªÅ cho client.</li></ul></li></ul></li></ul><p>üêó V·∫≠y l√† xong to√†n b·ªô ki·∫øn th·ª©c v·ªÅ JWT, b·∫°n c√≥ th·ªÉ l√†m th·ª≠ t·∫•t c·∫£ v√≠ d·ª• tr√™n nh√©, ƒë·ªÉ n·∫Øm ki·∫øn th·ª©c k·ªπ h∆°n.</p><p>‚ùî N·∫øu c√°c b·∫°n c√≥ th·∫Øc m·∫Øc g√¨, b·∫•t c·ª© g√¨ ch∆∞a r√µ, c·ª© comment ƒë·ªÉ m√¨nh gi·∫£i th√≠ch k·ªπ h∆°n nh√©üôÇ</p><p>C·∫£m ∆°n c√°c b·∫°n ƒë√£ theo d√µi b√†i vi·∫øt.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/security/>Security</a>
<a href=/tags/b%E1%BA%A3o-m%E1%BA%ADt/>B·∫£o m·∫≠t</a>
<a href=/tags/jwt/>JWT</a>
<a href=/tags/json-web-token/>JSON Web Token</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>L·∫≠p tr√¨nh d·ªÖ √≤m.xyz</span></section></footer></article><aside class=related-contents--wrapper></aside><script async src=https://telegram.org/js/telegram-widget.js?15 data-telegram-discussion=laptrinhdeom_channel/12 data-comments-limit=5 data-colorful=1 data-dark=1></script><footer class=site-footer><section class=copyright>&copy;
2021 L·∫≠p Tr√¨nh D·ªÖ √ím.xyz</section><section class=powerby><a href=https://t.me/laptrinhdeom target=_blank>Ch√©m gi√≥ tr√™n Telegram</a><br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.3.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>