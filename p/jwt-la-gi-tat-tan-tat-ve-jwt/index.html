<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="NÃ³ lÃ  viáº¿t táº¯t cá»§a `JSON Web Token`, JWT lÃ  1 chuá»—i JSON Ä‘Æ°á»£c mÃ£ hÃ³a, JWT lÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ giao tiáº¿p giá»¯a Back-End vÃ  Front-End"><title>JWT lÃ  gÃ¬? Táº¥t táº§n táº­t vá» JWT</title><link rel=canonical href=https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/><link rel=stylesheet href=/scss/style.min.css><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!="dataLayer"?"&l="+a:"";c.async=!0,c.src="https://www.googletagmanager.com/gtm.js?id="+g+h,f.parentNode.insertBefore(c,f)})(window,document,"script","dataLayer","GTM-NVL9VTK")</script><meta property="og:title" content="JWT lÃ  gÃ¬? Táº¥t táº§n táº­t vá» JWT"><meta property="og:description" content="NÃ³ lÃ  viáº¿t táº¯t cá»§a `JSON Web Token`, JWT lÃ  1 chuá»—i JSON Ä‘Æ°á»£c mÃ£ hÃ³a, JWT lÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ giao tiáº¿p giá»¯a Back-End vÃ  Front-End"><meta property="og:url" content="https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/"><meta property="og:site_name" content="Láº­p TrÃ¬nh Dá»… Ã’m.xyz"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Security"><meta property="article:tag" content="Báº£o máº­t"><meta property="article:tag" content="JWT"><meta property="article:tag" content="JSON Web Token"><meta property="article:published_time" content="2021-06-14T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-14T00:00:00+00:00"><meta property="og:image" content="https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover.png"><meta name=twitter:title content="JWT lÃ  gÃ¬? Táº¥t táº§n táº­t vá» JWT"><meta name=twitter:description content="NÃ³ lÃ  viáº¿t táº¯t cá»§a `JSON Web Token`, JWT lÃ  1 chuá»—i JSON Ä‘Æ°á»£c mÃ£ hÃ³a, JWT lÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ giao tiáº¿p giá»¯a Back-End vÃ  Front-End"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.laptrinhdeom.xyz/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-VMYS7CXX5Q"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-VMYS7CXX5Q',{anonymize_ip:!1})}</script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NVL9VTK" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.body.dataset.scheme='dark':document.body.dataset.scheme='light'})()</script><div class="container main-container flex on-phone--column extended article-page with-toolbar"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=/img/logo_hu24e9b3dbe3a18967143a698004067214_28795_300x0_resize_box_2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>ğŸ°</span></figure><h1 class=site-name><a href=https://www.laptrinhdeom.xyz>Láº­p TrÃ¬nh Dá»… Ã’m.xyz</a></h1><h2 class=site-description>Chia sáº» kiáº¿n thá»©c vÃ  kinh nghiá»‡m láº­p trÃ¬nh.</h2></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Trang chá»§</span></a></li><li><a href=/about-me/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>Giá»›i thiá»‡u</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Kho lÆ°u trá»¯</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>TÃ¬m kiáº¿m</span></a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></ol></aside><main class="main full-width"><div id=article-toolbar><a href=https://www.laptrinhdeom.xyz class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg><span>Back</span></a></div><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover_hu6769fb9f126c77eafe45523142ac731e_39456_800x0_resize_box_2.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/cover_hu6769fb9f126c77eafe45523142ac731e_39456_800x0_resize_box_2.png 800w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/cover_hu6769fb9f126c77eafe45523142ac731e_39456_1600x0_resize_box_2.png 1600w" width=800 height=342 loading=lazy alt="Featured image of post JWT lÃ  gÃ¬? Táº¥t táº§n táº­t vá» JWT"></a></div><div class=article-details><header class=article-category><a href=/categories/security/>Security</a>
<a href=/categories/b%E1%BA%A3o-m%E1%BA%ADt/>Báº£o máº­t</a>
<a href=/categories/jwt/>JWT</a>
<a href=/categories/json-web-token/>JSON Web Token</a></header><h2 class=article-title><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/>JWT lÃ  gÃ¬? Táº¥t táº§n táº­t vá» JWT</a></h2><h3 class=article-subtitle>NÃ³ lÃ  viáº¿t táº¯t cá»§a `JSON Web Token`, JWT lÃ  1 chuá»—i JSON Ä‘Æ°á»£c mÃ£ hÃ³a, JWT lÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ giao tiáº¿p giá»¯a Back-End vÃ  Front-End</h3><footer class=article-time><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--published>Jun 14, 2021</time></footer></div></header><section class=article-content><h3 id=-jwt-lÃ -gÃ¬-váº­y-nhá»‰>âœ… JWT lÃ  gÃ¬ váº­y nhá»‰?</h3><ul><li>NÃ³ lÃ  viáº¿t táº¯t cá»§a <code>JSON Web Token</code></li><li>JWT lÃ  1 chuá»—i JSON Ä‘Æ°á»£c mÃ£ hÃ³a, nÃ³ trÃ´ng tháº¿ nÃ y Ä‘Ã¢y:</li></ul><div class=highlight><pre class=chroma><code class=language-makefile data-lang=makefile><span class=err>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.</span>
<span class=err>eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.</span>
<span class=err>SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span>
</code></pre></div><ul><li>CÃ¡c báº¡n copy chuá»—i trÃªn, xong vÃ o <a class=link href=https://jwt.io/ target=_blank rel=noopener>Ä‘Ã¢y</a> dÃ¡n vÃ o xem thá»­ nÃ³ tháº¿ nÃ o nhÃ© ğŸ™‚</li><li>JWT lÃ  phÆ°Æ¡ng thá»©c Ä‘á»ƒ giao tiáº¿p giá»¯a Back-End vÃ  Front-End (<code>Stateless</code>).
NghÄ©a lÃ  Back-End chá»‰ táº¡o ra 1 chuá»—i token cho user khi Ä‘Äƒng nháº­p, vÃ  tráº£ chuá»—i nÃ y vá» Front-End, Back-End hoÃ n toÃ n khÃ´ng lÆ°u trá»¯ token nÃ y trÃªn server.</li><li>CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° hÃ¬nh dÆ°á»›i Ä‘Ã¢y:</li></ul><p><figure style=flex-grow:298;flex-basis:715px><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt.png data-size=2112x708><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt_hud5e499587e4094707b1a90ad61266e85_96008_480x0_resize_box_2.png 480w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/01-jwt_hud5e499587e4094707b1a90ad61266e85_96008_1024x0_resize_box_2.png 1024w" width=2112 height=708 loading=lazy alt=01-jwt.png></a><figcaption>01-jwt.png</figcaption></figure></p><h3 id=-táº¡i-sao-jwt-láº¡i-sinh-ra>âœ… Táº¡i sao JWT láº¡i sinh ra?</h3><ul><li>TrÆ°á»›c Ä‘Ã¢y chÃºng ta láº­p trÃ¬nh web, lÃºc Ä‘Ã³ Ä‘iá»‡n thoáº¡i di Ä‘á»™ng chÆ°a phá»• biáº¿n, nÃªn khÃ´ng cÃ³ app cho Ä‘iá»‡n thoáº¡i di Ä‘á»™ng, vÃ¬ tháº¿ chá»‰ sá»­ dá»¥ng cÆ¡ cháº¿ xÃ¡c thá»±c ngÆ°á»i dÃ¹ng báº±ng <code>Session Based</code>.</li><li>Session Based lÃ  gÃ¬?<ul><li><p>CÃ¡c báº¡n xem hÃ¬nh dÆ°á»›i Ä‘Ã¢y:</p><p><figure style=flex-grow:298;flex-basis:715px><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based.png data-size=2112x708><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based_hucdd257f931a157b5c0dadba83af15119_102105_480x0_resize_box_2.png 480w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/02-session-based_hucdd257f931a157b5c0dadba83af15119_102105_1024x0_resize_box_2.png 1024w" width=2112 height=708 loading=lazy alt=02-session-based.png></a><figcaption>02-session-based.png</figcaption></figure></p></li><li><p>CÃ¡c báº¡n tháº¥y nÃ³ cÅ©ng tÆ°Æ¡ng tá»± vá»›i JWT, nhÆ°ng khÃ¡c nhau chá»— khÃ´ng xÃ i JWT mÃ  xÃ i cookie pháº£i khÃ´ng?</p></li><li><p>ÄÃºng váº­y nÃ³ sáº½ dÃ¹ng <code>cookie</code> Ä‘á»ƒ Ä‘á»‹nh danh ngÆ°á»i dÃ¹ng, vÃ  <code>sessionId</code> sáº½ Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn phÃ­a server, á»Ÿ dáº¡ng text.</p></li><li><p>Äá»ƒ biáº¿t ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng nháº­p hay chÆ°a, vÃ  id cá»§a user lÃ  gÃ¬&mldr;</p></li></ul></li><li>Sau khi cÃ³ website cháº¡y vá»›i session based rá»“i, giá» Ä‘á»™t nhiÃªn cÃ³ nhu cáº§u thÃªm 1 app cho Ä‘iá»‡n thoáº¡i ná»¯a, váº­y pháº£i lÃ m tháº¿ nÃ o?</li><li>App trÃªn Ä‘iá»‡n thoáº¡i Ä‘Ã¢u cÃ³ cookie Ä‘á»ƒ xÃ i sessionId nhÆ° web Ä‘Æ°á»£c???</li><li>Cuá»‘i cÃ¹ng, 1 cÆ¡ cháº¿ má»›i Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a ra Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, Ä‘Ã³ lÃ  dÃ¹ng Json Web Token. NÃ³ mang chá»¯ web thÃ´i, nhÆ°ng xÃ i á»Ÿ Ä‘Ã¢u cÅ©ng Ä‘Æ°á»£c.</li></ul><h3 id=-trong-chuá»—i-jwt-cÃ³-nhá»¯ng-gÃ¬-váº­y>âœ… Trong chuá»—i JWT cÃ³ nhá»¯ng gÃ¬ váº­y?</h3><p>JWT cÃ³ 3 pháº§n: Header, Payload vÃ  Signature, chi tiáº¿t cÃ¡c báº¡n cÃ³ thá»ƒ xem hÃ¬nh dÆ°á»›i:</p><ul><li><p><code>Header</code>, trong header sáº½ cÃ³ 2 thuá»™c tÃ­nh:</p><ul><li><code>alg</code>: thuáº­t toÃ¡n mÃ£ hoÃ¡ cá»§a JWT, thÆ°á»ng sáº½ lÃ  <code>HS256</code></li><li><code>typ</code>: loáº¡i token, thÆ°á»ng sáº½ lÃ  <code>JWT</code></li></ul></li><li><p><code>Payload</code>: lÃ  nÆ¡i chá»©a cÃ¡c data cáº§n thiáº¿t Ä‘á»ƒ Ä‘á»‹nh danh user, vÃ­ dá»¥ user id, email, vÃ  cÃ¡c thÃ´ng tin khÃ¡c thÆ°á»ng dÃ¹ng nhÆ° sau:</p><p><a class=link href=https://www.notion.so/e79c084210a744018be222359ca0ce18 target=_blank rel=noopener>JWT Payload keys</a></p><ul><li>CÃ¡c thÃ´ng tin cÃ¡c cÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o á»Ÿ Ä‘Ã¢y: <a class=link href=https://en.wikipedia.org/wiki/JSON_Web_Token#Standard_fields target=_blank rel=noopener>https://en.wikipedia.org/wiki/JSON_Web_Token#Standard_fields</a></li></ul></li><li><p><code>Signature</code>: lÃ  chá»¯ kÃ½ Ä‘iá»‡n tá»­ cá»§a JWT, dÃ¹ng Ä‘á»ƒ verify JWT nÃ y cÃ³ Ä‘Æ°á»£c táº¡o ra Ä‘Ãºng khÃ´ng, dá»±a trÃªn thuáº­t toÃ¡n mÃ£ hoÃ¡ nhÆ° sau:</p><ol><li><code>base64UrlEncode(header)</code></li><li><code>base64UrlEncode(payload)</code></li><li><code>HMACSHA256(#1, #2, secretKey)</code></li></ol><ul><li><code>secretKey</code> lÃ  chuá»—i ngáº«u nhiÃªn Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn server</li><li><code>secretKey</code> dÃ¹ng Ä‘á»ƒ táº¡o ra Signature cho JWT vÃ  verify JWT cÃ³ há»£p lá»‡ hay khÃ´ng.</li></ul><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>signature</span> <span class=o>=</span> <span class=nx>HMACSHA256</span><span class=p>(</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>payload</span><span class=p>),</span>
  <span class=nx>secret</span>
<span class=p>);</span>

<span class=kd>var</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>payload</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span> <span class=nx>signature</span><span class=p>;</span>
</code></pre></div></li></ul><h3 id=-jwt-hoáº¡t-Ä‘á»™ng-tháº¿-nÃ o-váº­y>âœ… JWT hoáº¡t Ä‘á»™ng tháº¿ nÃ o váº­y?</h3><ul><li>CÆ¡ cháº¿ JWT khÃ¡ Ä‘Æ¡n giáº£n:<ul><li>Server sau khi xÃ¡c thá»±c Ä‘Ãºng user thÃ¬ tráº£ vá» 1 chuá»—i mÃ£ hoÃ¡ cho client</li><li>Client lÆ°u láº¡i mÃ£ nÃ y á»Ÿ local, cÃ³ thá»ƒ lÆ°u á»Ÿ <code>cookie, localStorate, AsyncStorage, SharedPreferences...</code> hay báº¥t cá»© Ä‘Ã¢u báº¡n muá»‘n mÃ  cÃ³ thá»ƒ truy cáº­p nhanh Ä‘á»ƒ láº¥y giÃ¡ trá»‹ lÃ  Ä‘Æ°á»£c.</li><li>Má»—i request sau lÃªn server thÃ¬ set JWT vÃ o header trÆ°á»›c khi gá»­i lÃªn.</li><li>Server láº¥y JWT tá»« header, <code>verify</code> coi thá»­ JWT cÃ³ há»£p lá»‡ khÃ´ng, há»£p lá»‡ thÃ¬ cho vÃ o, khÃ´ng thÃ¬ Ä‘Ã¡ lá»—i <code>401</code> vá» cho client.</li></ul></li><li>CÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o á»Ÿ hÃ¬nh dÆ°á»›i sáº½ chi tiáº¿t hÆ¡n:</li></ul><p><figure style=flex-grow:100;flex-basis:240px><a href=/p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow.png data-size=2112x2112><img src=/p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow.png srcset="/p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow_hu8d253bb90a7042289f3a77f2bb36fb04_295764_480x0_resize_box_2.png 480w, /p/jwt-la-gi-tat-tan-tat-ve-jwt/03-jwt-workflow_hu8d253bb90a7042289f3a77f2bb36fb04_295764_1024x0_resize_box_2.png 1024w" width=2112 height=2112 loading=lazy alt=03-jwt-workflow.png></a><figcaption>03-jwt-workflow.png</figcaption></figure></p><h3 id=-lÃ m-tháº¿-nÃ o-Ä‘á»ƒ-verify-jwt-cÃ³-há»£p-lá»‡-khÃ´ng-nhá»‰>âœ… LÃ m tháº¿ nÃ o Ä‘á»ƒ verify JWT cÃ³ há»£p lá»‡ khÃ´ng nhá»‰?</h3><ul><li>Äá»ƒ verify 1 chuá»—i JWT cÃ³ há»£p lá»‡ hay khÃ´ng thÃ¬ nÃ³ sáº½ tháº¿ nÃ y:<ul><li><p>Äáº§u tiÃªn, server sáº½ giáº£i mÃ£ (decode) chuá»—i JWT cá»§a header vÃ  payload ra, trong payload sáº½ cÃ³ cÃ¡c thÃ´ng tin nhÆ°:</p><ul><li><code>iss</code>: NgÆ°á»i táº¡o lÃ  ai</li><li><code>nbf</code>: Not before, token nÃ y cÃ³ tá»›i thÃ²i Ä‘iá»ƒm há»£p lá»‡ chÆ°a</li><li><code>exp</code>: Expiration time, token nÃ y cÃ³ háº¿t háº¡n chÆ°a</li></ul></li><li><p>Server kiá»ƒm tra cÃ¡c thÃ´ng tin trÃªn, náº¿u báº¥t cá»© thÃ´ng tin nÃ o khÃ´ng há»£p lá»‡, thÃ¬ sáº½ tráº£ lá»—i ra.</p></li><li><p>Tiáº¿p theo server sáº½ thá»­ hash header vÃ  payload vá»›i thuáº­t toÃ¡n táº¡o JWT trÃªn Ä‘á»ƒ so sÃ¡nh vá»›i Signature cÃ³ giá»‘ng khÃ´ng, náº¿u khÃ´ng giá»‘ng thÃ¬ cÅ©ng tráº£ ra lá»—i.</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>signature</span> <span class=o>=</span> <span class=nx>HMACSHA256</span><span class=p>(</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>
  <span class=nx>base64UrlEncode</span><span class=p>(</span><span class=nx>payload</span><span class=p>),</span>
  <span class=nx>secret</span>
<span class=p>);</span>
</code></pre></div></li><li><p>CÃ¡c báº¡n thá»­ táº¡o theo thuáº­t toÃ¡n nÃ y xem cÃ³ ra Ä‘Æ°á»£c chuá»—i JWT khÃ´ng nhÃ© ğŸ˜‰</p></li></ul></li></ul><h3 id=-thá»­-táº¡o-1-chuá»—i-jwt-báº±ng-nodejs-nhÆ°-tháº¿-nÃ o>âœ… Thá»­ táº¡o 1 chuá»—i JWT báº±ng NodeJS nhÆ° tháº¿ nÃ o?</h3><ul><li>BÃ¢y giá» chÃºng ta thá»­ dÃ¹ng NodeJS táº¡o ra 1 chuá»—i JWT thá»­ xem nhÃ©.<ul><li><p>Báº¡n táº¡o 1 file <code>create-jwt.js</code></p></li><li><p>Tiáº¿p tá»¥c báº¡n cháº¡y lá»‡nh: <code>npm init</code>, xong lÃ m theo hÆ°á»›ng dáº«n trÃªn terminal:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kr>package</span> <span class=nx>name</span><span class=o>:</span> <span class=p>(</span><span class=nx>demo</span><span class=o>-</span><span class=nx>jwt</span><span class=p>)</span> 
<span class=nx>version</span><span class=o>:</span> <span class=p>(</span><span class=mf>1.0.0</span><span class=p>)</span> 
<span class=nx>description</span><span class=o>:</span> 
<span class=nx>entry</span> <span class=nx>point</span><span class=o>:</span> <span class=p>(</span><span class=nx>index</span><span class=p>.</span><span class=nx>js</span><span class=p>)</span> 
<span class=nx>test</span> <span class=nx>command</span><span class=o>:</span> 
<span class=nx>git</span> <span class=nx>repository</span><span class=o>:</span> 
<span class=nx>keywords</span><span class=o>:</span> 
<span class=nx>author</span><span class=o>:</span> 
<span class=nx>license</span><span class=o>:</span> <span class=p>(</span><span class=nx>ISC</span><span class=p>)</span> 
<span class=nx>About</span> <span class=nx>to</span> <span class=nx>write</span> <span class=nx>to</span> <span class=o>/</span><span class=nx>home</span><span class=o>/</span><span class=nx>username</span><span class=o>/</span><span class=nx>demo</span><span class=o>-</span><span class=nx>jwt</span><span class=o>/</span><span class=kr>package</span><span class=p>.</span><span class=nx>json</span><span class=o>:</span>

<span class=p>{</span>
  <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=s2>&#34;demo-jwt&#34;</span><span class=p>,</span>
  <span class=s2>&#34;version&#34;</span><span class=o>:</span> <span class=s2>&#34;1.0.0&#34;</span><span class=p>,</span>
  <span class=s2>&#34;description&#34;</span><span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
  <span class=s2>&#34;main&#34;</span><span class=o>:</span> <span class=s2>&#34;index.js&#34;</span><span class=p>,</span>
  <span class=s2>&#34;scripts&#34;</span><span class=o>:</span> <span class=p>{</span>
    <span class=s2>&#34;test&#34;</span><span class=o>:</span> <span class=s2>&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>
  <span class=p>},</span>
  <span class=s2>&#34;author&#34;</span><span class=o>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
  <span class=s2>&#34;license&#34;</span><span class=o>:</span> <span class=s2>&#34;ISC&#34;</span>
<span class=p>}</span>

<span class=nx>Is</span> <span class=k>this</span> <span class=nx>OK</span><span class=o>?</span> <span class=p>(</span><span class=nx>yes</span><span class=p>)</span>
</code></pre></div></li><li><p>Giá» báº¡n cháº¡y tiáº¿p lá»‡nh nÃ y: <code>npm install jsonwebtoken</code></p></li><li><p>Xong táº¡o file <code>create-jwt.js</code> vá»›i ná»™i dung sau:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>

<span class=kd>var</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span>
  <span class=nx>sub</span><span class=o>:</span> <span class=s1>&#39;e271a680-3e55-45bd-bbcf-aa4576ac835f&#39;</span><span class=p>,</span>
  <span class=nx>iss</span><span class=o>:</span> <span class=s1>&#39;JWT Demo&#39;</span><span class=p>,</span>
  <span class=nx>iat</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>)</span> <span class=o>-</span> <span class=mi>30</span><span class=p>,</span>
  <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>test</span><span class=o>:</span> <span class=s1>&#39;abc&#39;</span>
  <span class=p>}</span>
<span class=p>},</span> <span class=s1>&#39;secretKey@123&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;1m&#39;</span> <span class=p>});</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=nx>token</span><span class=p>);</span>
</code></pre></div></li><li><p>Váº­y lÃ  xong pháº§n táº¡o JWT vá»›i nodejs rá»“i, giá» cháº¡y thá»­: <code>node create-jwt.js</code></p></li><li><p>Báº¡n sáº½ tháº¥y káº¿t quáº£ nhÆ° sau:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=nx>token</span> <span class=nx>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><span class=p>.</span>
      <span class=nx>eyJzdWIiOiJlMjcxYTY4MC0zZTU1LTQ1YmQtYmJjZi1hYTQ1NzZhYzgzNWYiLCJpc3MiOiJKV1QgRGVtbyIsImRhdGEiOnsidGVzdCI6ImFiYyJ9fQ</span><span class=p>.</span>
      <span class=mi>3</span><span class=nx>ibxGqZi7n</span><span class=o>-</span><span class=mi>3</span><span class=nx>MjwbuKAYBkFYVwf59qUZt6Q6nbgp_wI</span>
</code></pre></div></li><li><p>Báº¡n thá»­ copy quÄƒng vÃ´ <a class=link href=http://jwt.io target=_blank rel=noopener>jwt.io</a> xem thá»­ Ä‘Æ°á»£c thÃ´ng tin gÃ¬ nhÃ© ğŸ˜</p></li></ul></li></ul><h3 id=-thá»­-verify-chuá»—i-jwt-vá»›i-nodejs-nÃ o>âœ… Thá»­ verify chuá»—i JWT vá»›i nodejs nÃ o.</h3><ul><li>Sau khi táº¡o xong JWT thÃ¬ mÃ¬nh verify chuá»—i xem há»£p lá»‡ hay khÃ´ng nhÃ©.<ul><li><p>Táº¡o file <code>verify-jwt.js</code> vá»›i ná»™i dung sau:</p><div class=highlight><pre class=chroma><code class=language-jsx data-lang=jsx><span class=kd>var</span> <span class=nx>token</span> <span class=o>=</span> <span class=s1>&#39;...&#39;</span><span class=p>;</span> <span class=c1>// Thay token á»Ÿ trÃªn vÃ o chá»— dáº¥u ... hen.
</span><span class=c1></span>
<span class=k>try</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=s1>&#39;secretKey@123);
</span><span class=s1>  console.log(&#39;</span><span class=nx>token</span> <span class=nx>data</span><span class=s1>&#39;, decoded);
</span><span class=s1>} catch(err) {
</span><span class=s1>  console.log(&#39;</span><span class=nx>KhÃ´ng</span> <span class=nx>thá»ƒ</span> <span class=nx>verify</span> <span class=nx>token</span> <span class=nx>nÃ y</span><span class=err>&#39;</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div></li><li><p>Báº¡n cháº¡y thá»­ <code>node verify-jwt.js</code> xem káº¿t quáº£ tháº¿ nÃ o nhÃ© ğŸ˜‡</p></li></ul></li></ul><h3 id=-thá»­-hack-jwt-cÃ³-Ä‘Æ°á»£c-khÃ´ng>âœ… Thá»­ hack JWT cÃ³ Ä‘Æ°á»£c khÃ´ng?</h3><ul><li>BÃ¢y giá» mÃ¬nh cÃ³ tÃ¬nh huá»‘ng tháº¿ nÃ y:<ol><li>Báº¡n táº¡o 1 JWT á»Ÿ trÃªn</li><li>Copy dÃ¡n vÃ o <a class=link href=http://jwt.io target=_blank rel=noopener>jwt.io</a></li><li>Copy pháº§n <code>Signature</code> Ä‘á»ƒ giá»¯ láº¡i Ä‘Ã¢u Ä‘Ã³, cÃ³ thá»ƒ dÃ¡n vÃ o IDE Ä‘á»ƒ giá»¯ láº¡i tÃ­ mÃ¬nh cÃ³ viá»‡c dÃ¹ng láº¡i nhÃ© ğŸ˜‚</li><li>Sá»­a láº¡i payload pháº§n <code>sub</code> thÃ nh 1 id cá»§a admin</li><li><a class=link href=http://jwt.io target=_blank rel=noopener>jwt.io</a> tá»± táº¡o láº¡i 1 chuá»—i JWT má»›i, <code>Signature</code> hoÃ n toÃ n khÃ¡c.</li><li>Copy chuá»—i má»›i, dÃ¡n vÃ o file <code>verify-jwt.js</code> vÃ  cháº¡y thá»­.</li></ol></li><li>TÃ¬nh huá»‘ng khÃ¡c, tiáº¿p theo tÃ¬nh huá»‘ng trÃªn nhÃ©:<ol><li>Copy <code>Signature</code> lÃºc nÃ£y giá»¯ láº¡i.</li><li>DÃ¡n vÃ o pháº§n `</li></ol></li></ul><h3 id=-Æ°u-nhÆ°á»£c-Ä‘iá»ƒm-cá»§a-jwt-lÃ -gÃ¬>âœ… Æ¯u, nhÆ°á»£c Ä‘iá»ƒm cá»§a JWT lÃ  gÃ¬?</h3><p>(Äang cáº­p nháº­t)</p><h3 id=-lÃ m-sao-Ä‘á»ƒ-logout-1-user-Ä‘ang-xÃ i-jwt-há»£p-lá»‡-trÆ°á»›c-thá»i-háº¡n>âœ… LÃ m sao Ä‘á»ƒ logout 1 user Ä‘ang xÃ i JWT há»£p lá»‡ trÆ°á»›c thá»i háº¡n?</h3><ul><li>Khi sá»­ dá»¥ng <code>Session based</code> thÃ¬ <code>sessionId</code> Ä‘Æ°á»£c lÆ°u trÃªn server, khi user logout thÃ¬ chÃºng ta chá»‰ viá»‡c xÃ³a <code>sessionId</code> trÃªn server lÃ  xong.</li><li>NhÆ°ng Ä‘ang dÃ¹ng JWT, server khÃ´ng lÆ°u láº¡i, thÃ¬ lÃ m sao Ä‘á»ƒ logout user nhá»‰?<ul><li>KhÃ´ng cÃ³ cÃ¡ch nÃ o logout 1 user khi há» Ä‘ang sá»­ dá»¥ng JWT, nghÄ©a lÃ  cho dÃ¹ user Ä‘Ã£ nháº¥n nÃºt logout rá»“i, nhÆ°ng láº¥y JWT Ä‘Ã³ váº«n request lÃªn server bÃ¬nh thÆ°á»ng nhÃ©, server khÃ´ng há» biáº¿t Ä‘Æ°á»£c user Ä‘Ã£ logout rá»“i.</li><li>Váº­y cÃ¡ch nÃ o Ä‘á»ƒ tá»« chá»‘i cÃ¡c request sau khi user Ä‘Ã£ logout? ChÃºng ta cÃ³ 1 cÃ¡ch lÃ :<ul><li>Khi user logout, gá»­i token lÃªn server vá»›i request logout.</li><li>Server lÆ°u láº¡i JWT Ä‘Ã£ logout trÃªn Redis hoáº·c 1 nÆ¡i nÃ o Ä‘Ã³.</li><li>Báº¥t cá»© request nÃ o lÃªn server thÃ¬ server kiá»ƒm tra JWT cÃ³ trÃªn chá»— lÆ°u JWT Ä‘Ã£ logout hay khÃ´ng, náº¿u cÃ³ thÃ¬ tá»« chá»‘i request, Ä‘Ã¡ lá»—i 401 Unauthorized vá» cho client.</li></ul></li></ul></li></ul><p>ğŸ— Váº­y lÃ  xong toÃ n bá»™ kiáº¿n thá»©c vá» JWT, báº¡n cÃ³ thá»ƒ lÃ m thá»­ táº¥t cáº£ vÃ­ dá»¥ trÃªn nhÃ©, Ä‘á»ƒ náº¯m kiáº¿n thá»©c ká»¹ hÆ¡n.</p><p>â” Náº¿u cÃ¡c báº¡n cÃ³ tháº¯c máº¯c gÃ¬, báº¥t cá»© gÃ¬ chÆ°a rÃµ, cá»© comment Ä‘á»ƒ mÃ¬nh giáº£i thÃ­ch ká»¹ hÆ¡n nhÃ©ğŸ™‚</p><p>Cáº£m Æ¡n cÃ¡c báº¡n Ä‘Ã£ theo dÃµi bÃ i viáº¿t.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/security/>Security</a>
<a href=/tags/b%E1%BA%A3o-m%E1%BA%ADt/>Báº£o máº­t</a>
<a href=/tags/jwt/>JWT</a>
<a href=/tags/json-web-token/>JSON Web Token</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Láº­p trÃ¬nh dá»… Ã²m.xyz</span></section></footer></article><aside class=related-contents--wrapper></aside><script async src=https://telegram.org/js/telegram-widget.js?15 data-telegram-discussion=laptrinhdeom_channel/12 data-comments-limit=5 data-colorful=1 data-dark=1></script><footer class=site-footer><section class=copyright>&copy;
2021 Láº­p TrÃ¬nh Dá»… Ã’m.xyz</section><section class=powerby><a href=https://t.me/laptrinhdeom target=_blank>ChÃ©m giÃ³ trÃªn Telegram</a><br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=2.3.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>